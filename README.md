# ü•û fln

[![CI](https://github.com/nesvet/fln/actions/workflows/ci.yaml/badge.svg)](https://github.com/nesvet/fln/actions/workflows/ci.yaml)
[![npm](https://img.shields.io/npm/v/fln)](https://www.npmjs.com/package/fln)
[![license](https://img.shields.io/npm/l/fln)](LICENSE)

**Your entire codebase ‚Üí One AI-ready file.**

Stop wrestling with file pickers and attachment limits ‚Äî feed your whole project to any LLM in one shot.

```bash
fln .
```

Or run instantly:

```bash
npx fln . -o codebase.md
```

Works with **Claude**, **ChatGPT**, **Gemini**, **Grok**, **Cursor**, **Copilot**, and *any* AI tool.

**`fln`** (short for *flatten*) is **language-agnostic** by design: TypeScript, Python, Java, Go, Rust, Bash, SQL, mixed monorepos ‚Äî it treats everything as plain text, detects project metadata from common manifests (`package.json`, `pyproject.toml`, `go.mod`, `Cargo.toml`, `CMakeLists.txt`, `vcpkg.json`), respects `.gitignore`, and skips binaries by default.

## Why fln exists

If you use LLMs for real projects, you‚Äôve hit these limits:

- **Context windows** ‚Äî large projects don‚Äôt fit.
- **Upload friction** ‚Äî selecting dozens of files for every session.
- **Partial understanding** ‚Äî AI sees fragments, not the architecture.
- **Manual prep** ‚Äî repeating the same setup context again and again.

**`fln` removes that overhead.**  
It turns your project into a single, structured snapshot that LLMs can actually reason about.

## What fln enables

**‚Üí Full-context refactoring**  
Ask architectural questions that are impossible file-by-file:
> ‚ÄúWhere is the real coupling here?‚Äù  
> ‚ÄúWhat should be split into modules?‚Äù

**‚Üí Instant onboarding**  
One markdown file instead of ‚Äústart by opening these 12 folders‚Äù. Perfect for reading code on a tablet or onboarding new developers without an IDE.

**‚Üí Project-level code reviews**  
Let AI detect patterns, inconsistencies, and risks across the entire codebase.

**‚Üí Auditable Snapshots**  
Create a single, clean artifact of your codebase state for security reviews, compliance audits, or legal records without granting full repo access.

**‚Üí Dataset Preparation**  
Generate clean, formatted data for RAG pipelines and fine-tuning custom models.

**‚Üí LLM-friendly diffs**  
Flatten ‚Üí commit ‚Üí flatten again. See how the *whole project* changed structurally.

## Compatible with your AI workflow

- **Claude** ‚Äî ideal for large architectural prompts (200K+ tokens).
- **Gemini** ‚Äî push massive codebases into 1M token windows.
- **ChatGPT** ‚Äî single-shot analysis without attachments.
- **Cursor / Windsurf** ‚Äî reference the full project in prompts.
- **GitHub Copilot** ‚Äî better context ‚Üí better suggestions.
- **Local LLMs** ‚Äî datasets for RAG and fine-tuning.

## Built for real projects

- ‚ö° **Fast parallel scanning** ‚Äî thousands of files in seconds.
- üéØ **Smart filtering** ‚Äî respects `.gitignore`, excludes binaries, configurable size limits.
- üìÅ **Intentional file order** ‚Äî entry points and configs first, not alphabetical noise.
- üîÑ **Auto-detection** ‚Äî skips files previously generated by `fln`.
- üìê **Deterministic output** ‚Äî same input ‚Üí same snapshot.
- üß† **Project metadata detection** ‚Äî name & version from ecosystem-native manifests.
- üõ†Ô∏è **Developer-friendly** ‚Äî `Markdown` for humans, `JSON` for tooling, `--dry-run` mode for safety.
- üîí **No surprises** ‚Äî runs locally, no data leaves your machine.

Zero dependencies on external services. Zero tracking. Just a tool that does its job.

## Install

```bash
# npm
npm install -g fln

# one-liner (macOS/Linux)
curl -fsSL "https://raw.githubusercontent.com/nesvet/fln/main/install.sh" | sh

# one-liner (Windows)
irm "https://raw.githubusercontent.com/nesvet/fln/main/install.ps1" | iex

# or just run without installing
npx fln . -o codebase.md
```

<details>
<summary>More installation options</summary>

### One-line installer options (macOS/Linux)

Pin a version or custom install directory:

```bash
curl -fsSL "https://raw.githubusercontent.com/nesvet/fln/main/install.sh" | FLN_VERSION="<version>" INSTALL_DIR="$HOME/.local/bin" sh
```

### One-line installer options (Windows PowerShell)

```powershell
$env:FLN_VERSION = "<version>"
$env:INSTALL_DIR = "$env:LOCALAPPDATA\\fln\\bin"
irm "https://raw.githubusercontent.com/nesvet/fln/main/install.ps1" | iex
```

### Manual download (GitHub Releases)

```bash
curl -L "https://github.com/nesvet/fln/releases/latest/download/fln-macos-x64.tar.gz" | tar -xz -C /usr/local/bin
chmod +x /usr/local/bin/fln
fln --help
```

</details>

## Usage

```bash
fln [directory] [options]
```

Examples:

```bash
# Flatten entire project
fln .

# Exclude tests and fixtures
fln src -e "**/*.test.ts" -e "fixtures/"

# Force include a file (even if ignored)
fln . -i "dist/output.md"

# Generate JSON for tooling
fln . --no-contents --format json

# Preview without writing
fln . --dry-run

# Overwrite output file instead of creating codebase-1.md
fln . -o codebase.md -w
```

<details>
<summary>All CLI options</summary>

- `-o, --output <path>` Output file or directory
- `-w, --overwrite` Overwrite output file instead of adding numeric suffix
- `-e, --exclude <glob>` Exclude patterns (repeatable)
- `-i, --include <glob>` Force include patterns
- `--include-hidden` Include hidden files and directories
- `--no-gitignore` Ignore `.gitignore`
- `--max-size <size>` Max file size (`10mb`, `512kb`)
- `--max-total-size <size>` Max total included size
- `--no-contents` Exclude file contents
- `--no-tree` Exclude directory tree
- `--format <md|json>` Output format
- `--dry-run` Scan without writing output
- `--follow-symlinks` Follow symlinks
- `--no-ansi` Disable ANSI colors
- `--no-sponsor-message` Hide support message (also: `FLN_NO_SPONSOR=1`)
- `--generated-date <date>` Use this date in the "Generated" header (format: `YYYY-MM-DD HH:mm`)
- `--banner <text>` Add text at the beginning
- `--footer <text>` Add text at the end of the output
- `-q, --quiet` Minimal output
- `-V, --verbose` Verbose output with breakdown
- `--debug` Debug output with file list
- `-v, --version` Show version
- `-h, --help` Show help

</details>

## CI/CD & Automation

Integrate `fln` into your pipeline to keep your codebase ‚ÄúAI-ready‚Äù automatically.

### GitHub Actions: Auto-generate Snapshots

Generate a fresh `codebase.md` artifact on every push. Download it anytime to chat with LLMs about the *exact* state of your main branch or a specific PR without manual scanning.

Create `.github/workflows/codebase-snapshot.yaml`:

```yaml
name: Snapshot Codebase

on:
  push:
    branches: [ "main" ]
  pull_request:

jobs:
  snapshot:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - uses: actions/checkout@v6

      - name: Generate Snapshot
        # Generates codebase.md without installing fln globally
        run: npx fln . -o codebase.md -w --no-ansi

      - name: Upload Artifact
        uses: actions/upload-artifact@v6
        with:
          name: codebase-snapshot
          path: codebase.md
          retention-days: 7
```

### Git Hooks: Pre-commit Context Guard

Prevent accidental ‚Äúcontext bloat‚Äù (e.g., committing large datasets or wrong lockfiles) by failing commits if the flattened codebase exceeds a specific size. This ensures your project always fits within LLM context windows.

Add to your pre-commit hook (e.g., via `husky` or `lint-staged`):

```bash
# Fails the commit if the flattened codebase exceeds 5MB (configurable)
# --dry-run ensures no files are written to disk
npx fln . --dry-run --max-total-size 5mb
```

## JavaScript API

```typescript
import { fln } from "fln";

const result = await fln({
  rootDirectory: "./src",
  outputFile: "output.md",
  overwrite: true,
  excludePatterns: [ "*.test.ts", "fixtures/" ],
  format: "md",
  onProgress: (current, total) => {
    console.log(`Progress: ${current}/${total}`);
  }
});

console.log(`Processed ${result.files} files`);
console.log(`Output: ${result.outputPath}`);
console.log(`Tokens: ${result.outputTokenCount}`);
```

All CLI options are available via `FlnOptions`.


## Advanced

<details>
<summary>Configuration file (.fln.json)</summary>

```json
{
	"outputFile": "output.md",
	"overwrite": false,
	"excludePatterns": [
		"dist/",
		"**/*.snap"
	],
	"includePatterns": [],
	"includeHidden": false,
	"useGitignore": true,
	"maximumFileSizeBytes": "10mb",
	"maximumTotalSizeBytes": "0",
	"includeTree": true,
	"includeContents": true,
	"format": "md",
	"followSymlinks": false,
	"logLevel": "normal",
	"generatedDate": "2026-02-09 12:00",
	"banner": "This is a snapshot of the codebase.",
	"footer": "End of snapshot."
}
```

</details>

<details>
<summary>Output naming & formats</summary>

- Uses project name + version if available (`package.json`, `pyproject.toml`, `Cargo.toml`, `vcpkg.json`, `go.mod`, or `CMakeLists.txt`)  
- `md` includes tree + contents
- `json` includes `rootDirectory`, `tree`, `stats`

</details>

<details>
<summary>Runtime compatibility</summary>

**Node.js**
- Requires Node.js `>=18.3`
- ESM-only package (`"type": "module"`)
- CLI works via `npm i -g fln` or `npx fln`

**Bun**
- Requires Bun `>=1.0.0`
- CLI works via `bun install -g fln` or `bunx fln`

</details>

## Preview

Full real outputs are provided below. Each example is a compact project in [`examples/`](examples/). `fln` outputs the directory tree and file contents with **entry points and configs first** (intentional file order):

- [TypeScript](examples/ts-app.md)
- [Python](examples/python-app.md)
- [Java](examples/java-app.md)
- [Go](examples/go-app.md)
- [Rust](examples/rust-app.md)

## Support this project

**fln is free, open-source, and maintained by one developer.**

If it saves you time or improves your AI workflow:
- ‚≠êÔ∏è Star the repo ‚Äî it genuinely helps discoverability
- üíô Support on [Patreon](https://www.patreon.com/nesvet) ‚Äî priority features & long-term maintenance

## Contributing

PRs and issues are welcome.  
See [`CONTRIBUTING.md`](CONTRIBUTING.md) for setup and guidelines.

## License

MIT
